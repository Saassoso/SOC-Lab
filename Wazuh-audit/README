# Wazuh System Audit Integration - Auditd & Sysmon

## Overview

This document covers the integration of system audit capabilities with Wazuh SIEM using **Auditd** (Linux) and **Sysmon** (Windows). These tools provide detailed system activity monitoring, including process execution, network connections, file modifications, and security-relevant events that enhance threat detection capabilities.

System audit integration enables advanced threat hunting, compliance monitoring, and behavioral analysis across heterogeneous environments by capturing granular system events and forwarding them to the Wazuh Manager for centralized analysis.

---

## Integration Components

| Component | Platform | Purpose | Installation Guide |
| --------- | -------- | ------- | ------------------ |
| **Auditd** | Linux | System call auditing, file access monitoring | [ğŸ“– Auditd Integration](./Auditd/README.md) |
| **Sysmon** | Windows | Advanced Windows event logging | [ğŸ“– Sysmon Integration](./Sysmon/README.md) |

---

## General Server Configuration

All audit integrations communicate with the Wazuh Manager at:
**192.168.88.130**

---

## Monitoring Capabilities

### ğŸ§ Linux Auditd Monitoring
- **System Call Auditing**: Process execution, file access, network connections
- **Account Management**: User creation, modification, privilege escalation
- **File Integrity**: Real-time file modification detection with "who" data
- **Network Activity**: Socket creation, connection establishment
- **Privilege Escalation**: Sudo usage, setuid execution monitoring

### ğŸªŸ Windows Sysmon Monitoring
- **Process Activity**: Process creation, termination, image loads
- **Network Connections**: TCP/UDP connections, DNS queries
- **File System**: File creation, modification, stream creation
- **Registry Activity**: Registry key/value modifications
- **Image/Driver Loads**: DLL loading, driver installation events

---

## Directory Structure

```
Wazuh-audit/
â”œâ”€â”€ README.md                     # This overview document
â”œâ”€â”€ Auditd/
â”‚   â”œâ”€â”€ README.md                 # Auditd installation and configuration
â”‚   â”œâ”€â”€ configs/
â”‚   â”‚   â”œâ”€â”€ ossec.conf           # Wazuh agent configuration
â”‚   â”‚   â””â”€â”€ audit.rules           # Auditd rules configuration
â”‚   â”œâ”€â”€ rules/
â”‚   â”‚   â””â”€â”€ custom-auditd.xml    # Custom Wazuh detection rules
â”‚   â””â”€â”€ screenshots/             # Linux audit screenshots
â””â”€â”€ Sysmon/
    â”œâ”€â”€ README.md                 # Sysmon installation and configuration
    â”œâ”€â”€ configs/
    â”‚   â”œâ”€â”€ sysmon-config.xml    # Sysmon configuration file
    â”‚   â””â”€â”€ ossec.conf           # Wazuh agent configuration
    â””â”€â”€ screenshots/             # Windows Sysmon screenshots
 
```

---

## Key Features

### Enhanced Detection Capabilities
âœ… **Process Execution Monitoring** - Track all process creation with command lines  
âœ… **Account Manipulation Detection** - Monitor user/group modifications  
âœ… **File System Monitoring** - Real-time file access with user attribution  
âœ… **Network Connection Tracking** - Monitor all network activity  
âœ… **Registry Monitoring** - Windows registry change detection  
âœ… **Privilege Escalation Detection** - Monitor sudo usage and privilege changes  

### Compliance & Forensics
âœ… **Audit Trail Generation** - Complete system activity logging  
âœ… **Who Data Support** - User attribution for file system events  
âœ… **Regulatory Compliance** - Support for PCI-DSS, SOX, HIPAA requirements  
âœ… **Forensic Analysis** - Detailed event reconstruction capabilities  

### Performance Optimization
âœ… **Rule-Based Filtering** - Reduce noise with targeted monitoring  
âœ… **Efficient Log Processing** - Optimized for high-volume environments  
âœ… **Resource Management** - Minimal system impact configuration  

---

## Security Use Cases

### ğŸ¯ Threat Detection Scenarios

**Account Compromise Detection**
- Monitor failed authentication attempts
- Detect unusual account creation/modification
- Track privilege escalation activities

**Lateral Movement Detection**
- Network connection monitoring
- Remote process execution detection
- Credential usage tracking across systems

**Persistence Mechanism Detection**
- Registry modification monitoring (Windows)
- Startup script modifications (Linux)
- Scheduled task creation and modification

**Data Exfiltration Detection**
- Large file access patterns
- Network connection anomalies
- Unusual data access by user accounts

---

**Last Updated**: August 2025  
**Documentation**: Complete with testing procedures